<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>„É©„É≥„ÉÄ„É†„Ç®„Éº„Ç∏„Çß„É≥„Éà - VALORANT</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', sans-serif;
      background: #0a0a0a url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><rect fill="%23000" width="100" height="100"/><circle cx="50" cy="50" r="1" fill="%23ff4655" opacity="0.3"/></svg>');
      min-height: 100vh;
      padding: 0;
      color: #fff;
      overflow-x: hidden;
    }

    :root {
      --valorant-red: #ff4655;
      --valorant-dark: #0a0a0a;
      --valorant-border: #2a2a2a;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 50px;
    }

    .header h1 {
      font-size: 3.5em;
      margin-bottom: 10px;
      color: var(--valorant-red);
      text-transform: uppercase;
      font-weight: 900;
      letter-spacing: 3px;
      text-shadow: 0 0 20px rgba(255, 70, 85, 0.5);
    }

    .header p {
      font-size: 1.1em;
      color: #888;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .nav {
      display: flex;
      gap: 15px;
      margin-bottom: 40px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .nav a,
    .nav button {
      padding: 12px 30px;
      background: transparent;
      color: var(--valorant-red);
      text-decoration: none;
      border: 2px solid var(--valorant-red);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
    }

    .nav a::before,
    .nav button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--valorant-red);
      transition: left 0.2s ease;
      z-index: -1;
    }

    .nav a:hover::before,
    .nav button:hover::before {
      left: 0;
    }

    .nav a:hover,
    .nav button:hover {
      color: #000;
    }

    .nav a.active,
    .nav button.active {
      background: var(--valorant-red);
      color: #000;
    }

    .main-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 40px;
    }

    /* „Çπ„É≠„ÉÉ„ÉàÊ©üÊ¢∞„É°„Ç§„É≥ */
    .slot-machine-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
      width: 100%;
    }

    .slot-title {
      font-size: 2em;
      color: var(--valorant-red);
      text-transform: uppercase;
      letter-spacing: 2px;
      text-shadow: 0 0 10px rgba(255, 70, 85, 0.5);
    }

    .slots-display {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin: 30px 0;
    }

    .slot {
      width: 180px;
      height: 240px;
      border: 3px solid var(--valorant-red);
      background: rgba(0, 0, 0, 0.7);
      overflow: hidden;
      box-shadow: 
        inset 0 0 20px rgba(255, 70, 85, 0.3),
        0 0 20px rgba(255, 70, 85, 0.3);
      position: relative;
    }

    .slot-content {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
    }

    .slot-item {
      width: 100%;
      height: 240px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-bottom: 1px solid var(--valorant-border);
      background: rgba(255, 70, 85, 0.02);
      overflow: hidden;
      flex-shrink: 0;
    }

    .slot-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .slot-content.spinning {
      animation: slot-spin 0.08s linear infinite;
    }

    @keyframes slot-spin {
      0% {
        transform: translateY(0);
      }
      100% {
        transform: translateY(-240px);
      }
    }

    .slot-center-indicator {
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 240px;
      transform: translateY(-50%);
      border-top: 2px solid var(--valorant-red);
      border-bottom: 2px solid var(--valorant-red);
      background: rgba(255, 70, 85, 0.1);
      pointer-events: none;
      z-index: 10;
    }

    .controls-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      width: 100%;
      max-width: 500px;
    }

    .role-select {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .role-select label {
      font-size: 1em;
      color: var(--valorant-red);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .role-select select {
      width: 100%;
      padding: 12px;
      border: 2px solid var(--valorant-border);
      background: rgba(0, 0, 0, 0.5);
      color: var(--valorant-red);
      font-size: 1em;
      transition: all 0.2s ease;
      font-family: inherit;
      text-transform: uppercase;
    }

    .role-select select:hover,
    .role-select select:focus {
      border-color: var(--valorant-red);
      box-shadow: 0 0 10px rgba(255, 70, 85, 0.3);
      outline: none;
    }

    .role-select select option {
      background: #000;
      color: var(--valorant-red);
    }

    .quick-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
      width: 100%;
    }

    .quick-btn {
      padding: 10px;
      background: transparent;
      color: var(--valorant-red);
      border: 1px solid var(--valorant-border);
      cursor: pointer;
      font-weight: 700;
      text-transform: uppercase;
      font-size: 0.85em;
      letter-spacing: 0.5px;
      transition: all 0.2s ease;
    }

    .quick-btn:hover {
      background: rgba(255, 70, 85, 0.1);
      border-color: var(--valorant-red);
    }

    .quick-btn:active {
      background: var(--valorant-red);
      color: #000;
    }

    .main-button {
      width: 100%;
      padding: 20px;
      background: transparent;
      color: var(--valorant-red);
      border: 3px solid var(--valorant-red);
      font-size: 1.2em;
      font-weight: 900;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 2px;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .main-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--valorant-red);
      transition: left 0.2s ease;
      z-index: -1;
    }

    .main-button:hover::before {
      left: 0;
    }

    .main-button:hover:not(:disabled) {
      color: #000;
    }

    .main-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .stats-section {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      width: 100%;
    }

    .stat {
      flex: 1;
      background: rgba(255, 70, 85, 0.1);
      border: 1px solid var(--valorant-border);
      padding: 15px;
      text-align: center;
    }

    .stat-number {
      font-size: 2em;
      color: var(--valorant-red);
      font-weight: bold;
    }

    .stat-label {
      font-size: 0.8em;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-top: 5px;
    }

    /* „É¢„Éº„ÉÄ„É´„ÉÄ„Ç§„Ç¢„É≠„Ç∞ */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .modal.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: linear-gradient(135deg, rgba(20, 20, 20, 0.95), rgba(30, 30, 30, 0.95));
      border: 2px solid var(--valorant-red);
      border-radius: 0;
      padding: 40px;
      max-width: 600px;
      width: 90%;
      text-align: center;
      position: relative;
      overflow: auto;
      max-height: 90vh;
      box-shadow: 0 0 30px rgba(255, 70, 85, 0.5);
      animation: slideDown 0.5s ease;
    }

    @media (max-height: 800px) {
      .modal-content {
        padding: 20px;
        max-width: 500px;
      }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--valorant-red), transparent);
      opacity: 0.5;
    }

    .modal-close {
      position: absolute;
      right: 20px;
      top: 20px;
      font-size: 28px;
      font-weight: bold;
      color: var(--valorant-red);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .modal-close:hover {
      text-shadow: 0 0 10px rgba(255, 70, 85, 0.8);
    }

    .modal-image {
      width: 100%;
      max-width: 350px;
      height: auto;
      margin: 20px 0;
      animation: zoomIn 0.6s ease;
    }

    @media (max-height: 800px) {
      .modal-image {
        max-width: 250px;
        margin: 15px 0;
      }
    }

    @keyframes zoomIn {
      from {
        opacity: 0;
        transform: scale(0.5);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .modal-title {
      font-size: 2.5em;
      color: var(--valorant-red);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin: 20px 0;
      font-weight: 900;
      text-shadow: 0 0 20px rgba(255, 70, 85, 0.6);
      animation: pulse 0.6s ease;
    }

    @media (max-height: 800px) {
      .modal-title {
        font-size: 2em;
        margin: 15px 0;
      }
    }

    @keyframes pulse {
      0%, 100% {
        text-shadow: 0 0 20px rgba(255, 70, 85, 0.6);
      }
      50% {
        text-shadow: 0 0 30px rgba(255, 70, 85, 1);
      }
    }

    .modal-role {
      font-size: 1.3em;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin: 15px 0;
      font-weight: 700;
      border-top: 2px solid var(--valorant-red);
      border-bottom: 2px solid var(--valorant-red);
      padding: 15px 0;
    }

    @media (max-height: 800px) {
      .modal-role {
        font-size: 1em;
        margin: 10px 0;
        padding: 10px 0;
      }
    }

    .modal-description {
      color: #ccc;
      font-size: 1em;
      line-height: 1.7;
      margin: 20px 0;
      text-align: left;
      max-height: 200px;
      overflow-y: auto;
      padding-right: 15px;
    }

    @media (max-height: 800px) {
      .modal-description {
        font-size: 0.9em;
        max-height: 120px;
        margin: 15px 0;
      }
    }

    .modal-description::-webkit-scrollbar {
      width: 8px;
    }

    .modal-description::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.3);
    }

    .modal-description::-webkit-scrollbar-thumb {
      background: var(--valorant-red);
      border-radius: 4px;
    }

    .modal-description::-webkit-scrollbar-thumb:hover {
      background: #ff6655;
    }

    .modal-buttons {
      display: flex;
      gap: 15px;
      margin-top: 25px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .modal-buttons button {
      padding: 12px 30px;
      background: transparent;
      color: var(--valorant-red);
      border: 2px solid var(--valorant-red);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      position: relative;
      overflow: hidden;
      font-size: 1em;
    }

    @media (max-height: 800px) {
      .modal-buttons button {
        padding: 10px 20px;
        font-size: 0.85em;
      }
    }

    .modal-buttons button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--valorant-red);
      transition: left 0.2s ease;
      z-index: -1;
    }

    .modal-buttons button:hover::before {
      left: 0;
    }

    .modal-buttons button:hover {
      color: #000;
    }

    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #888;
    }

    .empty-state-icon {
      font-size: 4em;
      margin-bottom: 15px;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-20px);
      }
    }

    .empty-state p {
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 700;
    }

    @media (max-width: 768px) {
      .slots-display {
        gap: 20px;
      }

      .slot {
        width: 140px;
        height: 180px;
      }

      .slot-item {
        height: 180px;
      }

      @keyframes slot-spin {
        0% {
          transform: translateY(0);
        }
        100% {
          transform: translateY(-180px);
        }
      }

      .header h1 {
        font-size: 2.5em;
      }

      .slot-title {
        font-size: 1.5em;
      }

      .main-button {
        font-size: 1em;
        padding: 15px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>‚ö° AGENT SELECT</h1>
      <p>VALORANT PROTOCOL</p>
    </div>

    <div class="nav">
      <a href="/">CONSOLE</a>
      <button class="active">AGENT SELECT</button>
    </div>

    <div class="main-content">
      <!-- „Çπ„É≠„ÉÉ„ÉàÊ©üÊ¢∞„Çª„ÇØ„Ç∑„Éß„É≥ -->
      <div class="slot-machine-section">
        <div class="slot-title">üé∞ SPIN THE SLOTS</div>
        
        <div class="slots-display">
          <div class="slot">
            <div class="slot-center-indicator"></div>
            <div class="slot-content" id="slot0"></div>
          </div>
          <div class="slot">
            <div class="slot-center-indicator"></div>
            <div class="slot-content" id="slot1"></div>
          </div>
          <div class="slot">
            <div class="slot-center-indicator"></div>
            <div class="slot-content" id="slot2"></div>
          </div>
        </div>
      </div>

      <!-- Âà∂Âæ°„Çª„ÇØ„Ç∑„Éß„É≥ -->
      <div class="controls-section">
        <div class="role-select">
          <label for="roleSelect">SELECT ROLE:</label>
          <select id="roleSelect">
            <option value="random">üé≤ RANDOM</option>
            <option value="duelist">‚öîÔ∏è DUELIST</option>
            <option value="sentinel">üõ°Ô∏è SENTINEL</option>
            <option value="initiator">üîé INITIATOR</option>
            <option value="controller">üå´Ô∏è CONTROLLER</option>
          </select>
        </div>

        <div class="quick-buttons" id="quickButtons"></div>

        <button class="main-button" id="spinButton" onclick="spinSlots()">üéØ SPIN THE SLOTS</button>

        <div class="stats-section">
          <div class="stat">
            <div class="stat-number" id="totalSpins">0</div>
            <div class="stat-label">SPINS</div>
          </div>
          <div class="stat">
            <div class="stat-number" id="totalWins">0</div>
            <div class="stat-label">WINS</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- „É¢„Éº„ÉÄ„É´„ÉÄ„Ç§„Ç¢„É≠„Ç∞ -->
  <div id="resultModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal()">&times;</span>
      <div class="modal-title" id="resultTitle">CONGRATULATIONS!</div>
      <img id="resultImage" class="modal-image" alt="Agent">
      <div class="modal-role" id="resultRole">ROLE</div>
      <div class="modal-description" id="resultDescription">DESCRIPTION</div>
      <div class="modal-buttons">
        <button onclick="spinSlots()">üé≤ SPIN AGAIN</button>
        <button onclick="closeModal()">CLOSE</button>
      </div>
    </div>
  </div>

  <script>
    let allAgents = [];
    let spinCount = 0;
    let isSpinning = false;
    let selectedResults = [];

    // „Ç®„Éº„Ç∏„Çß„É≥„ÉàÂèñÂæó
    async function loadAgents() {
      try {
        const response = await fetch("/api/agents");
        const data = await response.json();
        allAgents = data.agents || [];
        console.log(`Loaded ${allAgents.length} agents`);
      } catch (error) {
        console.error("Failed to load agents:", error);
      }
    }

    // „Çπ„É≠„ÉÉ„ÉàÂàùÊúüÂåñ
    function initializeSlots() {
      console.log(`Initializing slots with ${allAgents.length} agents`);
      
      for (let slotIndex = 0; slotIndex < 3; slotIndex++) {
        const slotContent = document.getElementById(`slot${slotIndex}`);
        slotContent.innerHTML = '';
        slotContent.style.transform = 'translateY(0px)';
        
        // ÂêÑ„Çπ„É≠„ÉÉ„Éà„Å´„Ç®„Éº„Ç∏„Çß„É≥„ÉàÁîªÂÉè„ÇíÈÖçÁΩÆÔºàÂÖ®„Ç®„Éº„Ç∏„Çß„É≥„Éà √ó 3„É´„Éº„Éó„ÅßÂçÅÂàÜ„Å´„Çπ„Éî„É≥„Åß„Åç„Çã„Çà„ÅÜ„Å´Ôºâ
        for (let loop = 0; loop < 3; loop++) {
          allAgents.forEach((agent) => {
            const item = document.createElement('div');
            item.className = 'slot-item';
            const img = document.createElement('img');
            img.src = `/agents/${agent.image}`;
            img.alt = agent.name;
            img.onerror = function() {
              console.error(`Failed to load image: /agents/${agent.image}`);
            };
            item.appendChild(img);
            slotContent.appendChild(item);
          });
        }
      }
    }

    // „Çπ„É≠„ÉÉ„Éà„Çπ„Éî„É≥
    async function spinSlots() {
      if (isSpinning || allAgents.length === 0) {
        console.warn('Cannot spin:', { isSpinning, agentCount: allAgents.length });
        return;
      }
      
      isSpinning = true;
      const spinBtn = document.getElementById('spinButton');
      spinBtn.disabled = true;

      // „Çπ„É≠„ÉÉ„Éà„Çí„É™„Çª„ÉÉ„Éà
      for (let slotIndex = 0; slotIndex < 3; slotIndex++) {
        const slotContent = document.getElementById(`slot${slotIndex}`);
        slotContent.style.transform = 'translateY(0px)';
      }

      // „É©„É≥„ÉÄ„É†„Å´3„Å§„ÅÆ„Ç®„Éº„Ç∏„Çß„É≥„Éà„ÇíÈÅ∏Êäû
      selectedResults = [
        allAgents[Math.floor(Math.random() * allAgents.length)],
        allAgents[Math.floor(Math.random() * allAgents.length)],
        allAgents[Math.floor(Math.random() * allAgents.length)]
      ];

      console.log('Selected results:', selectedResults.map(a => a.name));

      // „Çπ„É≠„ÉÉ„Éà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÈñãÂßã
      for (let slotIndex = 0; slotIndex < 3; slotIndex++) {
        const slotContent = document.getElementById(`slot${slotIndex}`);
        slotContent.classList.add('spinning');
      }

      // „Çπ„Éî„É≥Á∂ôÁ∂öÊôÇÈñìÔºà„É©„É≥„ÉÄ„É†„Å´2-3ÁßíÔºâ
      const spinDuration = 2000 + Math.random() * 1000;
      await new Promise(resolve => setTimeout(resolve, spinDuration));

      // „Çπ„É≠„ÉÉ„ÉàÂÅúÊ≠¢
      for (let slotIndex = 0; slotIndex < 3; slotIndex++) {
        const slotContent = document.getElementById(`slot${slotIndex}`);
        slotContent.classList.remove('spinning');
        
        // ÁµêÊûú„ÅÆ„Ç®„Éº„Ç∏„Çß„É≥„Éà„Åå‰∏≠Â§Æ„Å´Êù•„Çã‰ΩçÁΩÆ„ÇíË®àÁÆó
        const resultAgent = selectedResults[slotIndex];
        const agentIndex = allAgents.findIndex(a => a.id === resultAgent.id);
        
        console.log(`Slot ${slotIndex}: ${resultAgent.name} at index ${agentIndex}`);
        
        if (agentIndex !== -1) {
          // „Çπ„É≠„ÉÉ„ÉàÂàùÊúüÂåñÊôÇ„Å´3„É´„Éº„ÉóÂàÜ„ÅÆ„Ç®„Éº„Ç∏„Çß„É≥„Éà„ÇíÈÖçÁΩÆ„Åó„Å¶„ÅÑ„Çã„ÅÆ„Åß„ÄÅ
          // ‰∏≠Â§Æ„Å´Ë°®Á§∫„Åô„Çã„Å´„ÅØÂêÑ„É´„Éº„Éó„ÅÆÊúÄÂàù„ÅÆ‰ΩçÁΩÆ„Åã„ÇâË®àÁÆó
          // „É´„Éº„Éó1„ÅÆ‰ΩçÁΩÆ = agentIndex * 240
          const offset = agentIndex * 240;
          slotContent.style.transform = `translateY(-${offset}px)`;
          console.log(`  Offset: -${offset}px`);
        }
      }

      // ÁµêÊûúË°®Á§∫Ââç„Å´Â∞ë„ÅóÈÅÖÂª∂
      await new Promise(resolve => setTimeout(resolve, 500));

      // ÊúÄÂàù„ÅÆ„Çπ„É≠„ÉÉ„Éà„ÅÆ„Ç®„Éº„Ç∏„Çß„É≥„Éà„ÇíÁµêÊûú„Å®„Åó„Å¶Ë°®Á§∫
      displayResult(selectedResults[0]);

      spinCount++;
      document.getElementById('totalSpins').textContent = spinCount;

      isSpinning = false;
      spinBtn.disabled = false;
    }

    // ÁµêÊûúË°®Á§∫
    function displayResult(agent) {
      if (!agent) return;

      document.getElementById('resultTitle').textContent = agent.name;
      document.getElementById('resultImage').src = `/agents/${agent.image}`;
      document.getElementById('resultRole').textContent = agent.role;
      document.getElementById('resultDescription').textContent = agent.description;

      // Áµ±Ë®àÊõ¥Êñ∞
      const totalWins = parseInt(document.getElementById('totalWins').textContent) + 1;
      document.getElementById('totalWins').textContent = totalWins;

      showModal();
    }

    // „É¢„Éº„ÉÄ„É´Ë°®Á§∫
    function showModal() {
      const modal = document.getElementById('resultModal');
      modal.classList.add('show');
    }

    // „É¢„Éº„ÉÄ„É´Èñâ„Åò„Çã
    function closeModal() {
      const modal = document.getElementById('resultModal');
      modal.classList.remove('show');
    }

    // „ÇØ„Ç§„ÉÉ„ÇØ„Éú„Çø„É≥ÁîüÊàê
    function createQuickButtons() {
      const roles = [
        { value: 'random', label: 'üé≤ RANDOM' },
        { value: 'duelist', label: '‚öîÔ∏è DUELIST' },
        { value: 'sentinel', label: 'üõ°Ô∏è SENTINEL' },
        { value: 'initiator', label: 'üîé INITIATOR' },
        { value: 'controller', label: 'üå´Ô∏è CONTROLLER' }
      ];

      const container = document.getElementById('quickButtons');
      roles.forEach(role => {
        const btn = document.createElement('button');
        btn.className = 'quick-btn';
        btn.textContent = role.label;
        btn.onclick = () => {
          document.getElementById('roleSelect').value = role.value;
          spinSlots();
        };
        container.appendChild(btn);
      });
    }

    // „É¢„Éº„ÉÄ„É´ËÉåÊôØ„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
    window.addEventListener('click', (event) => {
      const modal = document.getElementById('resultModal');
      if (event.target === modal) {
        closeModal();
      }
    });

    // ESC„Ç≠„Éº„ÅßÈñâ„Åò„Çã
    window.addEventListener('keydown', (event) => {
      if (event.key === 'Escape') {
        closeModal();
      }
    });

    // ÂàùÊúüÂåñ
    window.addEventListener('DOMContentLoaded', async () => {
      await loadAgents();
      console.log(`Total agents loaded: ${allAgents.length}`);
      initializeSlots();
      createQuickButtons();
      console.log("Page initialized");
    });
  </script>
</body>
</html>
